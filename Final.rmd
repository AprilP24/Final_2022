---
title: "Covid91 vaccine study Final2023"
author: "April Parry"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "7/31/2023" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
FinalData$treatment <- relevel(FinalData$treatment,ref="placebo")
#FinalData$infected <- relevel(FinalData$infected,ref="OK")
Male = filter(FinalData, sex =="M")
Female = filter(FinalData, sex =="F")
LGBTQ= filter(FinalData, LGBTQ =="gay")
Druguser = filter(FinalData, DrugUser =="yes")
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

#METHOD
the method here is  to change the data in this final data so that we can factor variables then arrange the ones who were treated with the placebo and the vaccine and the others who are infected with covid and see the differences betwwen the males, females, LGBTQ's and drugusers.  

## Males
## barchart

```{r}
basic <- Male %>% group_by(infected,treatment) %>% 
summarize(count=n()) %>% mutate(prcnt=count/sum(count))
basicC <- ggplot(basic,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")
basicCC <- ggplot(basic,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```


The chart above shows the percentages of men who have covid and got infected with placeabo and  got infected with the vaccine. The men who got infected with placeabo stand at 60% while the others who also caught covid and got infected with the vaccine stand at 30%. And the one's who are ok stand tall at 50% and above. 


#Numerical 
```{r}
table1 <- xtabs(~infected + treatment, data=Male)
rowPerc(table1)
colPerc(table1)
```
The numerical results above shows percentages of males that got covid-19 after taking the placebo and taking the vaccine. The other 2.55 males were given the placebo and were infected and 97.45 were not infected. This shows that many more people who were given the placebo were not infected as supposed to those who were infected.

### Inferential 

```{r}
chisq.test(table1)
chisqtestGC(table1)
guysfish <- fisher.test(table1)
guysfish
```

From the data above it shows that for men the 95 percent confidence interval is 1.798 for the placebo and 2.81 for the vaccine the odds ratio is 2.242522 the p value = 4.632e-14.

```{r}
effect <- guysfish$p.value/(guysfish$p.value +1)
effectivenessguy = guysfish$estimate/(guysfish$estimate +1)*100
print(effectivenessguy)
```

```{r}
low=(guysfish$conf.int[1]/(guysfish$conf.int[1] +1))*100
hi=(guysfish$conf.int[2]/(guysfish$conf.int[2] +1))*100
options(digits=2)
```

 the data above is the effectiveness for the covid-19 vaccine for males. Based on the interval ,the odds ratio for the  males are 69. Which tells us how effective the vaccine was.

## Females
```{r}
basic <- Female %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
basicC <- ggplot(basic,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")
basicCC <- ggplot(basic,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

The females who had covid and took the vaccine is around 58%, (almost 60) of them got sick and the ones who took the placebo is about 40 to at least 42% got covid and the ones who didn't get sick the ones who got the placebo it is about 50% and about 49% took the vaccine.

#Numerical 

```{r}
table1 <- xtabs(~infected + treatment, data=Female)
rowPerc(table1)
colPerc(table1)
``` 


## LGBTQ



## Druggies


# Overall Results and Conclusions